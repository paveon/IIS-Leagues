{% extends 'leagues/base.html' %}
{% block title %}Leagues | Games {% endblock %}

{% block content %}
    <!-- Middle Column -->
        <div style="flex: 1 1 auto">
            <div class="w3-container flex-container">
                {% for game in game_list %}
                    <div class="w3-card-4 flex-item gameCard">
                        <header class="w3-block w3-center gameImg">
                            <button type="button" class="w3-display-topleft w3-white gameEdit"
                                    onclick="$('#game_edit_' + {{ game.id }}).show()">
                                <i class="fa fa-pencil"></i>
                            </button>
                            {% if game.image_url %}
                                <img src="{{ game.image_url }}" alt="{{ game.name }}" style="width: 300px">
                            {% else %}
                                <h3 class="w3-text-white w3-display-middle">No image</h3>
                            {% endif %}
                        </header>
                        <div class="w3-container w3-center">
                            <a href="{% url 'leagues:game_detail' game.slug %}"><h3
                                    style="margin-bottom: 0">{{ game.name }}</h3></a>
                            <div id="game_info_{{ game.id }}" class="accordion">
                                <ul class="w3-ul">
                                    <li>Released: {{ game.release_date|default:"unknown" }}</li>
                                    <li>Genre: {{ game.genre|default:"unknown" }}</li>
                                    <li>Publisher: {{ game.publisher|default:"unknown" }}</li>
                                </ul>
                            </div>
                        </div>
                        <button onclick="showGameInfo(event, 'game_info_{{ game.id }}')" class="w3-block w3-button"
                                style="padding: 0; margin-top: 6px">
                            <i class="fa fa-angle-double-down"></i>
                        </button>
                    </div>
                {% endfor %}
            </div>
            <!-- End Middle Column -->
        </div>
{% endblock %}

{% block endpage %}
{% load widget_tweaks %}
{% for form in edit_forms %}
    <div id="{{ form.prefix }}" class="w3-modal" {% if form.errors %}
         style="display: block" {% endif %}>
        <div class="w3-modal-content w3-card-4" style="max-width:600px">

            <header class="w3-container w3-center w3-light-grey w3-border-bottom">
                <h3>Edit '{{ form.name.value }}'</h3>

                <button onclick="$('#{{ form.prefix }}').hide()" type="button"
                        class="w3-button w3-display-topright w3-red">
                    <i class="fa fa-times"></i>
                </button>
            </header>

            <form method="POST" class="" action="{% url 'leagues:games' %}" name="game_edit">
                <div class="w3-section w3-container">
                    {% csrf_token %}
                    {% if form.errors %}
                        <div class="w3-container w3-padding-16 w3-margin-bottom w3-red w3-round-large">
                            {{ form.errors }}
                        </div>
                    {% endif %}

                    <label><b>{{ form.name.label_tag }}</b></label>
                    {% render_field form.name class+="w3-input w3-border w3-margin-bottom" %}

                    <label><b>{{ form.release_date.label_tag }}</b></label>
                    <div class='w3-cell-row w3-margin-bottom'>
                        {% render_field form.release_date class+="w3-input w3-border w3-cell" %}
                        <div class="w3-cell w3-cell-middle w3-center w3-border date_icon">
                            <span class="fa fa-calendar"></span>
                        </div>
                    </div>

                    <label><b>{{ form.publisher.label_tag }}</b></label>
                    {% render_field form.publisher class+="w3-input w3-border w3-margin-bottom" %}
                    <label><b>{{ form.image_url.label_tag }}</b></label>
                    {% render_field form.image_url class+="w3-input w3-border w3-margin-bottom" %}
                    <label><b>{{ form.genre.label_tag }}</b></label>
                    {% render_field form.genre class+="w3-input w3-border w3-margin-bottom" %}
                    <label><b>{{ form.game_modes.label_tag }}</b></label>
                    {% render_field form.game_modes class+="w3-input w3-border" %}
                </div>
                <div class="w3-container w3-border-top w3-padding-16 w3-light-grey">
                    <button onclick="$('#{{ form.prefix }}').hide()" type="button"
                            class="w3-button w3-red">Close
                    </button>

                    <input type="hidden" name="game_id" value="{{ form.instance.id }}">
                    <input class="w3-button w3-green w3-right" type="submit" name="{{ form.prefix }}"
                           value="Save changes">
                </div>
            </form>
        </div>
    </div>
{% endfor %}
{% endblock %}
