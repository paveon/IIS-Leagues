<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- saved from url=(0067)https://www.fit.vutbr.cz/study/courses/IIS/private/projekt/doc.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-2">
    
    <title>Projekt IIS</title>
    <style type="text/css">
    	table { border-collapse: collapse; }
    	td, th { border: 1px solid black; padding: 0.3em 0.5em; text-align: left; }
    	dt { font-weight: bold; margin-top: 0.5em; }

		div p {
			text-indent: 2em;
			text-align: justify;
			line-height: 135%;
		}
    </style>
</head>
<body cz-shortcut-listen="true">

<!-- Zkontrolujte prosím nastavení kódování v hlavièce dokumentu 
     podle pou¾itého editoru -->

<h1>Liga Elektronického Sportu</h1> <!-- Nahradte názvem svého zadání -->

<dl>
	<dt>Autoøi</dt>
	<dd>Ondøej Pavela <!-- Nahraïte skuteèným jménem a e-mailem autora a popisem èinnosti -->
	    <a href="mailto:xpavel34@stud.fit.vutbr.cz">xpavel34@stud.fit.vutbr.cz</a> -
		V¹echny druhy èinností (python, návrh modelù, html ¹ablony, javascript)
	</dd>
	<dd>Robert Navrátil <!-- Nahraïte skuteèným jménem a e-mailem autora a popisem èinnosti -->
	    <a href="mailto:xnavra61@stud.fit.vutbr.cz">xnavra61@stud.fit.vutbr.cz</a> - 
		V¹echny druhy èinností (python, návrh modelù, html ¹ablony, javascript)
	</dd>
	<dt>URL aplikace</dt>
	<dd><a href="http://www.stud.fit.vutbr.cz/~xautor01/IIS">http://www.stud.fit.vutbr.cz/~xautor01/IIS</a></dd>
</dl>

<h2>U¾ivatelé systému pro testování</h2>
<p>Uveïte prosím existující zástupce <strong>v¹ech rolí u¾ivatelù</strong>.</p>
<table>
<tbody><tr><th>Login</th><th>Heslo</th><th>Role</th></tr>
<tr><td>admin</td><td>admin</td><td>Administrátor</td></tr>
<tr><td>staff</td><td>staff</td><td>Správce údajù</td></tr>
<tr><td>user</td><td>user</td><td>Hráè</td></tr>
</tbody></table>

<h2>Implementace</h2>
<div style="width:600px;">
	<p>
		Pro implementaci projektu jsme zvolili programovací jazyk python a webový framework Django. 
		Z toho dùvodu se li¹í pou¾ité principy a strukturování projektu. Kód tedy není rozdìlen
		do jednotlivých PHP skriptù, které se starají o jednu èinnost. Místo toho tvoøí jádro
		na¹eho informaèního systému tøi hlavní python skripty: <i>forms.py</i>, <i>models.py</i> a 
		<i>views.py</i>. Za zmínku stoji je¹tì skript <i>model_actions.py</i>. Ten obsahuje
		implementaci ruzných obecných funkcí operujících nad modely hráèù, klanù a týmù. Zároveò
		zabraòují duplikaci kódu, jeliko¾ je stejná funkcionalita èasto potøeba na více místech
		v informaèním systému.
	</p>

	<h3>Databáze</h3>
	<p>
		Django vyu¾ívá objektovì relaèního mapování, co¾ nám umo¾nilo specifikovat strukturu
		databáze pomocí tzv. Django modelù. Nejedná se o nic jiného ne¾ obyèejné python tøídy,
		které dìdí z bázové tøídy <b>Model</b>, jen¾ se nachází v modulu <i>django.db.models</i>
		V ka¾dém modelu poté staèí pomocí tøídních atributù definovat jednotlivé jeho prvky,
		které se poté mapují na konkrétní sloupce v databazové tabulce daného modelu. Django
		poskytuje pomìrnì ¹irokou ¹kálù základních typù prvkù modelu. Typy prvkù jsou opìt
		reprezentovány tøídami z modulu <i>django.db.models</i>. V na¹em pøípadì
		jsme nejèastìji pou¾ívali napø. tøídy <b>CharField</b>, <b>TextField</b>, <b>DateTimeField</b>
		nebo <b>DurationField</b>. Pro definici vztahù mezi modely poté slou¾í tøídy
		<b>OneToOneField</b> (1:1), <b>ForeignKey</b> (1:n) a <b>ManyToManyField</b> (m:n).
		Pro vztahy m:n Django automaticky vytváøí vazební tabulky, pøípadnì lze definovat
		vlastní model vazební tabulky, pokud potøebujeme uchovávat dodateèné informace u samotného vztahu.
		Pøi deklaraci jednotlivých ukládaných prvkù modelu je samozøejmì mo¾né specifikovat
		rùzná integritní omezení v konstruktorech døíve zmínìných tøíd. Je tedy mo¾né
		urèit, zda je povolena prázdná hodnota prvku (<i>null</i>), zda mají být hodnoty prvku
		unikátní, co se má stát pøi smazání navázané entity a podobnì.
	</p>

	<p>
		V na¹em øe¹ení jsou ve¹keré pou¾ívané modely definovány v souboru <i>models.py</i>
		a mezi ty nejdùle¾itìj¹í se øadí napøíklad <b>Player</b>, <b>Team</b>
		a <b>Clan</b>. V nìkterých pøípadech vyu¾íváme python dekorátoru metod <i>@property</i>
		pro specifikaci vypoèítaných atributù modelu, které nejsou ulo¾eny fyzicky v databázi.
		Dále je mo¾né u modelu pøedefinovat <b>save</b> metodu volanou v¾dy, kdy¾ je
		objekt ukládán do databáze. Této mo¾nosti jsme témìø výhradnì vyu¾ili pro naplnìní
		tzv. <b>SlugField</b> prvkù modelù pøed samotným ulo¾ením objektu. Jedná se
		o prvky, které v na¹em pøípadì obsahují napøíklad názvy her, týmu a podobnì v upravené
		podobì, která je vhodná pro vyu¾ití v URL adresách. Tedy pùvodní text, jeho¾ písmena
		jsou pøevedena na malá a mezery na pomlèky.
	</p>

	<h3>Views</h3>
	<p>
		Je jádro celého systému, které je tvoøeno jednotlivými 'pohledy' s pøíslu¹nou ¹ablonou, 
		nad kterou operují. Views je mo¾né definovat jako funkce, èi tøídy, a ka¾dá z tìchto èástí
		urèuje operace nad jednou stránkou. V obecných pohledech pracujícími s více daty
		jsme zdìdili <i>TemplateView</i> a pro pohledy jednotlivých prvkù, které pracují primárnì 
		nad jedním objektem (napø. detail hráèe), jsme vyu¾ili <i>DetailView</i>.
		Ka¾dý z nich obsahuje zdìdìnou funkci pro pøená¹ení kontextu (<b>get_context_data</b>), 
		metody <b>get</b> a <b>post</b> a <b>__init__</b>, které je mo¾né pøedefinovat.
		Pøedefinováním funkce <b>get_context_data</b> jsme dosahovali po¾adované funkcionality a 
		dosa¾itelnosti dat v html ¹ablonách, tak¾e je zde vìt¹ina dotazù do databáze. Data jsou 
		v ¹ablonách pøístupná pøes klíèe v kontextovém slovníku, který tato funkce vrací. 
		Dále bylo obèas nutné zmìnit i funkce <b>get</b> a <b>post</b>, ve kterých jsme pøípadnì, 
		dle svého uvá¾ení, zpracovávali pøijatá data a reagovali na nì chybou nebo pøekreslením stránky.
		Chyba je èasto odpovìdí pøes ajax pøi ¹patném pou¾ití nìjakého z formuláøù.
	</p>

	<h3>Formuláøe a o¹etøení u¾ivatelských vstupù</h3>
	<p>
		
	</p>

	<h3>HTML ©ablony</h3>
	<p>
		Django obsahuje integrovaný systém <b>HTML</b> ¹ablon. Díky tomu se mù¾ou v <b>HTML</b> kódu 
		vyskytovat i pøíkazy pro <i>Python</i> jako podmínky, èi vyu¾ívání kontextových promìnných.
		Syntax pro promìnné je <b>{{ <i>prommena</i> }}</b>, kde <i>promenna</i> je klíè v kontextovém
		slovníku. Pro podmínky, èi cykly, je zápis <b>{% <i>if</i> nebo <i>for</i> %}</b> a po klíèových
		slovech následuje daná podmínka nebo hlavièka cyklu jako v pythonu, av¹ak nelze vyu¾ívat 
		<i>range(x)</i>, proto¾e zápis v ¹ablonách nepodporuje závorky. Dal¹ím prvkem ¹ablon je pou¾ití
		blokù k odstranìní redundance. V tomto projektu máme základní ¹ablonu <i>base.html</i>, ve které
		jsou definovány ve¹keré spoleèné javascripty a prvky stránky jako patièka, èi levý panel (ten je
		ov¹em o¹etøen podmínkou pro nepøihlá¹ené u¾ivatele). Ostatní ¹ablony tedy pou¾ijí <i>include</i>
		<b>base</b> ¹ablony a není tedy nutná redundance.
	</p>

	<h3>Integritní omezení</h3>
	<p>
		V této podkapitole vysvìtlím ty èásti systému, jejich¾ funkènost nemusí být zøejmá z diagramu u¾ití, 
		a nebo mají slo¾ité závislosti a rùzná integritní omezení. Hlavnimi èástmi systému jsou klany, 
		týmy, hráèi, hry, zápasy a turnaje. V¹echny tyto objekty je mo¾né vytvoøit pøes stránku admina. 
		Pro hry jsou zde také herní módy a ¾ánr, pøièem¾ herní mód definuje poèet hráèù v zápase. Dále 
		jsou zde týmy. Jednotlivé týmy mají herní zamìøení a mohou být pod klanem, nebo bez klanu.
		Týmy bez klanu se nemohou úèastnit turnajù. Klany jsou skupinou týmù. Jedním z problémù by mohl být tým,
		který chce být pøizván do klanu. Taková mo¾nost je validní pouze pokud v¹ichni èlenové týmu patøí
		do klanu, do nìho¾ jde tým. Situace pøi odcházení velitelù týmù a klanù jsou øe¹eny výbìrem prvního v 
		databázi, a nebo sám velitel pøedá svou roli nìkomu z èlenù. Pokud odejde poslední hráè, tak je tým 
		nebo klan bez velitele a první hráè, který vstoupí, je automaticky pøijat a je ihned velitelem. Nyní k integritním omezením
		hráèù. Pøi tvorbì hráèe se automaticky vytvoøí u¾ivatel s generickým heslem a naopak pøi vytvoøení
		u¾ivatele se vytvoøí hráè. Hráè mù¾e po¾ádat o èlenství v klanu i v týmech, av¹ak pokud chce
		vstoupit do týmu s klanem, tak je automaticky pøizván i do daného klanu. Po pøijetí do klanu 
		se zru¹í v¹echny pozvánky do ostatních klanù a do v¹ech týmù, které mají jiný klan, ne¾ ve kterém
		se hráè aktuálnì nachází. Do týmu klanu nemù¾e být pøijat, dokud není èlenem klanu. Toto se v¹ak
		nevztahuje na týmy bez klanu. Tato omezení jsou potøebná z dùvodu, ¾e hráè mù¾e být pouze v 
		jednom klanu, proto¾e nastávaly problémy se statistikami a rùzné informace mohly být kvúli 
		tomu nepøesné. Hráè se tedy mù¾e nacházet ve více týmech, ale pouze v jednom klanu, a také mù¾e být 
		zamìøen na více her. Turnaje mù¾ou vytváøet pouze správci dat, nebo admin. Po vytvoøení zápasu jsou
		pro jednoduchost v¹echna data náhodnì vybrána a vygenerována z pøíslu¹ných týmù a týmy jsou logicky
		nedostupné, dokud neskonèí zápas. Zápasy mohou vytváøet pouze velitelé týmù.
	</p>
</div>

<img src="use_case.png" style="width: 1200px; border: 2px solid black;"/>
<p>Struèná dokumentace k implementaci, která popisuje, které PHP skripty implementují jednotlivé pøípady pou¾ití uvedené v use-case diagramu z IDS. V pøípadì, ¾e bylo nutno pøi implementaci uèinit zmìny v návrhu, musí být v dokumentaci zdùvodnìny.</p>

<h2>Instalace</h2>
<ul>
<li>Struènì popi¹te postup instalace na server</li>
<li>Softwarové po¾adavky (verze PHP apod.)</li>
<li>Jak rozbalit, konfigurovat, inicializovat databází, ...</li>
</ul>

<h2>Známé problémy</h2>
<p>Zde popi¹te, které body zadání (IDS a IIS) nejsou implementovány a z jakého dùvodu. Napø. &#8222;Z èasových dùvodù nebyla implementována správa u¾ivatelù.&#8221; Pomù¾ete tím zrychlit opravování, kdy¾ neimplementované funkce nebudeme muset dlouze hledat.</p>
<div style="width:600px;">
	<p>
		Jak ji¾ bylo zmínìno v Integritních omezeních, tak pøi vytváøení zápasù jsou ve¹keré události a v¹echno generováno ihned, proto¾e vkládání jednotlivých akcí
		by bylo napojeno na hru a ruèní plnìní by bylo zbyteènì èasovì nároèné. Po vytvoøení je tedy známý u¾ budoucí vítìz a èas i v¹e ostatní.
		Dal¹í odchylkou od zadání je vyhledávání dat. V hlavièkách tabulek mìly být implementovány rùzné filtry, ale u¾ v samotných tabulkách se vcelku dobøe hledá a 
		na filtry, èi jiné typy vyhledávání, nám bohu¾el nezbyl èas.
	</p>
</div>


</body></html>